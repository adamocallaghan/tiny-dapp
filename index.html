<!DOCTYPE html>

<html>
    <head>
        <title>Tiny Dapp</title>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Arimo&family=Prata&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="styles.css">
    </head>
    <body>
        <div id="main">
            <h1 id="title">Tiny Dapp</h1>
            <button class="button" onclick="connectMetamask()" id="connect">Connect Metamask</button>
            <h2>Your Metamask wallet is connected with account: <span id="walletAddress"></span></h2> 
            <h2>And you are connected to: <span id="blockchain"></span></h2>
        </div>
    </body>
    <script>
        let account;
        const connectMetamask = async() => {
            console.log("connectMetamask clicked!");
            if (window.ethereum !== undefined) {
                console.log(window.ethereum);
                const accounts = await ethereum.request({method: "eth_requestAccounts"});
                const chainId = await ethereum.request({ method: 'eth_chainId' });
                account = accounts[0];
                console.log(account);
                document.getElementById("walletAddress").innerHTML = account;
                if(chainId == "0x1") {
                    document.getElementById("blockchain").innerHTML = "Ethereum";
                }
            } else if(window.ethereum == undefined) {
                let noMetamask = "Metamask is not installed";
                console.log(noMetamask);
                document.getElementById("walletAddress").innerHTML = noMetamask;
            }
        }
    </script>
</html>